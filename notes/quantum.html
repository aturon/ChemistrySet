<html> 
        <head> 
                <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
                <title>JavaScript Surface Plot</title> 
                

                <!--[if IE]><script type="text/javascript" src="http://surface-plot.googlecode.com/svn/trunk/javascript/excanvas.js"></script><![endif]--> 
				<script type="text/javascript" src='jsplot/SurfacePlot.js'></script> 
				<script type="text/javascript" src='jsplot/ColourGradient.js'></script> 
                <script type="text/javascript" src="http://www.google.com/jsapi"></script> 
        </head>
<body>
		
    <script type='text/javascript'>
			
      google.load("visualization", "1");
      google.setOnLoadCallback(setUp);
			
        function isIE() {
          return /msie/i.test(navigator.userAgent) && !/opera/i.test(navigator.userAgent);
        }
	
        function setUp() {
          var numRows = 13;
          var numCols = 8;
				
          var tooltipStrings = new Array();
          var data = new google.visualization.DataTable();
				
          for (var i = 0; i < numCols; i++)
          {
            data.addColumn('number', 'col'+i);
          }
				
          data.addRows(numRows);
          var idx = 0;

          var bench = [
            [65.6454642340747,264.93128472984,213.016137479589,247.946298747049,262.969436905196,323.42144953169,278.261162829541,321.078306339089],
            [103.6808222883,295.85959094733,254.191540386148,274.165968012965,311.465878165852,321.949651020297,295.341347942135,329.660303619963],
            [77.1263581535093,255.436463812188,181.711318350489,124.323726677474,123.401648548829,124.147549774716,126.265127338155,177.603734517694],
            [52.5610781811035,270.165215439287,182.737978347007,142.993841799466,128.349415156403,112.438799345409,112.046410975626,142.269018928596],
            [187.249432425301,237.607166677069,165.503376448445,132.294160066561,215.238364767633,237.980809091367,260.264019392185,176.056649632973],
            [54.8849417510881,199.958726557279,151.522185494167,127.457323715784,191.10416793383,164.745306000177,147.476517548071,117.850203252145]
          ];

          var bench = [
[115.408852226125,510.337957382379,352.585219677111,425.671805168027,420.471292643768,461.811713658803,423.618883806073,469.128878798419],
[20.6725447957478,326.603960016193,327.169926898744,393.155884239032,375.390848252,422.530485002059,417.037345041143,395.827389490656],
[25.0729957034851,363.842653846154,360.809182626388,367.90570924219,381.5874437485,399.061551891071,422.356051654906,420.63861936009],
[18.0166987024289,352.89401247158,307.498638068688,339.198107226538,357.949931892788,397.755944815431,417.596444486876,364.2502695748],
[8.45607484951609,276.764593781344,242.392667811694,246.109518312692,282.16654821157,330.015695023802,342.015266863524,363.459465440293],
[35.840282138944,321.939605633718,209.861330848184,163.042377012713,178.059723380906,256.493116903086,270.159615682043,357.54955174712],
[8.57401648754698,286.154651805414,205.088578274384,149.014985431944,154.894971504234,159.436714496931,150.128766524379,225.548437101167],
[39.8024994595433,267.159757466931,185.01249878356,166.645321695909,165.097882459964,146.077611550096,165.477641932029,176.224171167543],
[52.5783184751659,284.125853739559,199.424443704055,144.567741165363,190.915766331718,163.898556534001,354.660027008984,315.136170466788],
[47.8591655217297,260.742133718295,188.253364332078,185.34328661337,241.134943063347,230.832139219657,316.428014968115,249.495231865407],
[118.383451172733,309.393476703178,235.750032441107,190.112360929028,369.908881166908,524.289800154932,369.44038825515,517.039676848241],
[97.7873017953299,288.578950348783,961.301398182219,796.284581378921,1942.50315038157,475.815150215899,756.354139904076,1114.76722166522],
[347.532552878309,422.412654267342,301.749518256029,258.629792156409,918.050678130709,769.389046507111,700.596091532972,1175.64926984657]
          ];

var bench = [
[1,0.558349512247472,0.813505512993687,0.723692996137361,0.749947344038341,0.699801706562285,0.766829334141926,0.703286945123785],
[1,0.784375891732486,0.894405792772138,0.832901006285871,0.901202404420611,0.837884304413375,0.863990826383238,0.918695667464463],
[1,0.878795804260424,1.02739664665366,1.10292384428878,1.13147592322862,1.13158509942494,1.1070641279941,1.13233957663032],
[1,1.07102874909472,1.40143787044554,1.48789627628555,1.54589548802074,1.50489420651275,1.50093518981133,1.71961993150809],
[1,1.38918115251138,1.89900428723429,2.2380118663166,2.34602708661583,2.31618034817605,2.39361599991311,2.39612137722177],
[1,1.55033487517361,2.33785999800458,3.09119377041561,3.55217150411425,3.49444577532377,3.71353668321876,3.40808909461737],
[1,1.72313845392834,2.55772780535884,3.4262940619349,4.10410306640592,4.72363910837287,5.39674308449394,5.29158896576164],
[1,1.84892402495155,2.76463681019394,3.62461941809789,4.42548017514924,5.2712783063315,5.90807458305463,6.52333368557536],
[1,1.90705448964241,2.85286312953204,3.81066817193315,4.60723086407362,5.51483900079456,5.69258399315865,6.4866309202421],
[1,1.95040077375172,2.91898680278203,3.85640026006789,4.70736036050577,5.5980880847484,6.27038027871358,7.24244624443751],
[1,1.9700720139118,2.94731123643856,3.92352298645385,4.7503464292797,5.4949842696049,6.51214438892507,7.13027112344746],
[1,1.9837036822524,2.86328829433923,3.79899976394225,4.29269273796818,5.72929542684656,6.42757887139355,6.94953228533369],
[1,1.99044447153209,2.98393447585091,3.97364699943094,4.80326853065974,5.76252845483584,6.70505594674128,7.3567298330986]
];

var bench = [
[0,0.691650487752528,0.550130850642676,0.704878432434068,0.720640891255777,0.800198293437714,0.754909796292856,0.835174593337753],
[0,0.715624108267514,0.905594207227862,1.16709899371413,1.24165473843653,1.41211569558662,1.4693425069501,1.48130433253554],
[0,0.805414722055366,1.15442153516452,1.45707615571122,1.72566693391423,1.96518909412344,2.18705351906472,2.32711988282914],
[0,0.735422863808505,1.06915036484858,1.53913075074148,1.95410451197926,2.4020825376733,2.75993437540606,2.85180863992048],
[0,0.497611300318809,0.77956714133714,1.15181864215798,1.6862309779003,2.29920426720857,2.7534428236163,3.23768143967963],
[0,0.384447733522047,0.472666317784891,0.54145929080888,0.853769089945151,1.64016960929161,2.1088932233233,3.0646381781099],
[0,0.23959446532632,0.332516097080182,0.358137075789651,0.542955757123491,0.756129677754293,0.887347824596964,1.76986354820484],
[0,0.12994921448507,0.172645419771214,0.251242650867632,0.369741667854171,0.424667639614449,0.67052073467112,0.920374923696163],
[0,0.0810170809341289,0.111563747938319,0.118604912546223,0.275581635926384,0.310403717652041,1.06417276359811,1.19091226593832],
[0,0.0428727688491752,0.0609014653743945,0.103510653072418,0.226046964688463,0.302354393127711,0.590700206402185,0.572938370947111],
[0,0.0261401073003196,0.0413466085519922,0.0538355041121887,0.211988787292802,0.448624752951492,0.409056361543969,0.764859962694858],
[0,0.01416450037329,0.13032306324728,0.188236541677318,0.686057040675344,0.23886307306499,0.527890292769728,0.991156152442128],
[0,0.00835624803616519,0.0124698389713012,0.0191659372829749,0.184760200385755,0.219525383648705,0.269834447838231,0.609810696676341]
];

          var work = [10,18,32,56,100,178,316,562,1000,1778,3162,5623,10000]

          var max = 0
          var min = 100000
          for (var i = 0; i < numRows; i++) {	
	    for (var j = 0; j < numCols; j++) {
	      if (bench[i][j] > max) max = bench[i][j]	
	      if (bench[i][j] < min) min = bench[i][j]	
            }
          }
			
          for (var i = 0; i < numRows; i++) {	
	    for (var j = 0; j < numCols; j++) {
	      data.setValue(i, j, (bench[i][j] - min)/(max - min));		
	      tooltipStrings[idx] = "w:" + work[i] + ", threads:" + j + " = " + bench[i][j];
	      idx++;
	    }
          }

         var surfacePlot = new greg.ross.visualisation.SurfacePlot(document.getElementById("surfacePlotDiv"));

         // Don't fill polygons in IE. It's too slow.
         var fillPly = !isIE();
//	 var fillPly = false;

         // Define a colour gradient.
         var colour1 = {red:0, green:0, blue:255};
         var colour2 = {red:0, green:255, blue:255};
         var colour3 = {red:0, green:255, blue:0};
         var colour4 = {red:255, green:255, blue:0};
         var colour5 = {red:255, green:0, blue:0};
         var colours = [colour1, colour2, colour3, colour4, colour5];

         // Axis labels.
         var xAxisHeader = "Work between critical sections";
         var yAxisHeader = "Threads";
         var zAxisHeader = "Speedup: predicted - real";

         var options = {xPos: 50, yPos: 50, width: 900, height: 700, colourGradient: colours,
		   fillPolygons: fillPly, tooltips: tooltipStrings, xTitle: xAxisHeader,
		   yTitle: yAxisHeader, zTitle: zAxisHeader};
				
        surfacePlot.draw(data, options);
      }
			
      </script>
		
      <div id='surfacePlotDiv'>
        <!-- SurfacePlot goes here... -->
			
      </div>
		
    </body>
</html>
